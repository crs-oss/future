<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å†™ç»™äº”å¹´åçš„è‡ªå·±</title>
<style>
body{font-family:"ZCOOL XiaoWei",serif;background:#05070d;color:#f2f2f2;text-align:center;padding:40px;}
textarea{width:100%;max-width:500px;padding:12px;margin:10px 0;border-radius:12px;border:none;font-family:inherit;}
button{padding:10px 28px;margin:5px;border-radius:30px;border:1px solid rgba(255,255,255,.6);background:transparent;color:inherit;cursor:pointer;}
#savedNotice,#countdown{margin-top:10px;color:lightgreen;}
</style>
</head>
<body>

<h2>ğŸ“ å†™ç»™äº”å¹´åçš„è‡ªå·±</h2>
<p>å†™ä¸‹ä½ æƒ³ç»™æœªæ¥è‡ªå·±çš„è¯ï¼š</p>
<textarea id="pastText" placeholder="æ­£æ–‡å†…å®¹"></textarea>
<textarea id="lockTextInput" placeholder="é”å®šå†…å®¹ï¼Œæœªæ¥è§£é”æ˜¾ç¤º"></textarea><br>

<button id="saveBtn">ğŸ’¾ ä¿å­˜ä¿¡ä»¶</button>
<button id="syncToCloudBtn">ğŸ“¤ åŒæ­¥åˆ°äº‘ç«¯</button>
<button class="clearBtn">ğŸ—‘ï¸ æ¸…é™¤å·²ä¿å­˜å†…å®¹</button>

<p id="savedNotice"></p>
<p id="countdown"></p>

<script>
// è¯»å–æœ¬åœ°ä¿å­˜
document.getElementById("pastText").value = localStorage.getItem("pastText") || "";
document.getElementById("lockTextInput").value = localStorage.getItem("lockText") || "";

// ä¿å­˜æœ¬åœ°
document.getElementById("saveBtn").onclick = () => {
  const past = document.getElementById("pastText").value;
  const lock = document.getElementById("lockTextInput").value;
  if(!past && !lock) return alert("è¯·è‡³å°‘è¾“å…¥ä¸€äº›å†…å®¹ï¼");
  localStorage.setItem("pastText", past);
  localStorage.setItem("lockText", lock);
  document.getElementById("savedNotice").innerText = "âœ… å·²ä¿å­˜æœ¬åœ°ï¼";
};

// æ¸…é™¤æœ¬åœ°
document.querySelectorAll(".clearBtn").forEach(btn=>{
  btn.onclick = () => {
    localStorage.removeItem("pastText");
    localStorage.removeItem("lockText");
    document.getElementById("pastText").value = "";
    document.getElementById("lockTextInput").value = "";
    document.getElementById("savedNotice").innerText = "ğŸ—‘ï¸ å·²æ¸…é™¤å†…å®¹";
    document.getElementById("countdown").innerText = "";
  }
});

// å€’è®¡æ—¶æ˜¾ç¤º
const targetDate = new Date("2026-01-15T10:30:00").getTime(); // ä¿®æ”¹æˆä½ å¸Œæœ›çš„æ—¥æœŸæ—¶é—´
const countdownEl = document.getElementById("countdown");

setInterval(()=>{
  const now = new Date().getTime();
  const diff = targetDate - now;

  if(diff <= 0){
    countdownEl.innerText = "ğŸ“¬ ä¿¡ä»¶å·²åˆ°æœŸï¼Œå°†è‡ªåŠ¨å‘é€é‚®ä»¶ï¼ˆé€šè¿‡äº‘ç«¯ Apps Scriptï¼‰";
  } else {
    const d = Math.floor(diff/86400000);
    const h = Math.floor((diff%86400000)/3600000);
    const m = Math.floor((diff%3600000)/60000);
    const s = Math.floor((diff%60000)/1000);
    countdownEl.innerText = `âŒ› ä¿¡ä»¶è¿˜å‰© ${d}å¤© ${h}å°æ—¶ ${m}åˆ† ${s}ç§’`;
  }
},1000);

// åŒæ­¥åˆ°äº‘ç«¯ Google Sheet
document.getElementById("syncToCloudBtn").onclick = async () => {
  const past = document.getElementById("pastText").value;
  const lock = document.getElementById("lockTextInput").value;

  const webAppUrl = "https://script.google.com/macros/s/AKfycbwT23iRGtgJwTZ-H4kdrqyJBwsuVDOUbq5FHKT5MdfidroRl6zVlk5yV9G8QiqpoqHv/exec"; // æ›¿æ¢æˆä½  Apps Script Web App URL

  try {
    const res = await fetch(webAppUrl, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ past, lock }),
      mode: "cors"  // ä¿ç•™ CORS
    });

    const data = await res.text();
    alert("âœ… å·²åŒæ­¥åˆ°äº‘ç«¯: " + data);
  } catch(e) {
    alert("âŒ åŒæ­¥å¤±è´¥: " + e);
  }
};

</script>

</body>
</html>
