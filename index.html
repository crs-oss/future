<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å†™ç»™äº”å¹´åçš„è‡ªå·±</title>
<style>
body{font-family:"ZCOOL XiaoWei",serif;background:#05070d;color:#f2f2f2;text-align:center;padding:40px;}
textarea{width:100%;max-width:500px;padding:12px;margin:10px 0;border-radius:12px;border:none;font-family:inherit;}
button{padding:10px 28px;margin:5px;border-radius:30px;border:1px solid rgba(255,255,255,.6);background:transparent;color:inherit;cursor:pointer;}
#savedNotice,#countdown{margin-top:10px;color:lightgreen;}
</style>
</head>
<body>

<h2>ğŸ“ å†™ç»™äº”å¹´åçš„è‡ªå·±</h2>
<p>å†™ä¸‹ä½ æƒ³ç»™æœªæ¥è‡ªå·±çš„è¯ï¼š</p>
<textarea id="pastText" placeholder="æ­£æ–‡å†…å®¹"></textarea>
<textarea id="lockTextInput" placeholder="é”å®šå†…å®¹ï¼Œæœªæ¥è§£é”æ˜¾ç¤º"></textarea><br>

<button id="saveBtn">ğŸ’¾ ä¿å­˜ä¿¡ä»¶</button>
<button class="clearBtn">ğŸ—‘ï¸ æ¸…é™¤å·²ä¿å­˜å†…å®¹</button>

<p id="savedNotice"></p>

<script>
// è¯»å–æœ¬åœ°ä¿å­˜
document.getElementById("pastText").value = localStorage.getItem("pastText") || "";
document.getElementById("lockTextInput").value = localStorage.getItem("lockText") || "";

// ä¿å­˜åˆ° Google Sheet
document.getElementById("saveBtn").onclick = async () => {
  const past = document.getElementById("pastText").value;
  const lock = document.getElementById("lockTextInput").value;
  if(!past && !lock) return alert("è¯·è‡³å°‘è¾“å…¥ä¸€äº›å†…å®¹ï¼");

  // æœ¬åœ°ä¿å­˜
  localStorage.setItem("pastText", past);
  localStorage.setItem("lockText", lock);

  // âš ï¸ è¿™é‡Œç”¨ GET è¯·æ±‚å‘é€åˆ° Apps Script Web App
  const webAppUrl = "https://script.google.com/macros/s/AKfycbwT23iRGtgJwTZ-H4kdrqyJBwsuVDOUbq5FHKT5MdfidroRl6zVlk5yV9G8QiqpoqHv/exec"; // æ­¥éª¤3å¾—åˆ°
  const params = new URLSearchParams({ past, lock });

  try {
    const res = await fetch(webAppUrl + "?" + params.toString());
    const text = await res.text();
    alert("âœ… å·²åŒæ­¥åˆ°äº‘ç«¯ (é€šè¿‡è¡¨å•æäº¤)!");
  } catch(e) {
    alert("âŒ åŒæ­¥å¤±è´¥: " + e);
  }
};

// æ¸…é™¤
document.querySelectorAll(".clearBtn").forEach(btn => {
  btn.onclick = () => {
    localStorage.removeItem("pastText");
    localStorage.removeItem("lockText");
    document.getElementById("pastText").value = "";
    document.getElementById("lockTextInput").value = "";
    document.getElementById("savedNotice").innerText = "ğŸ—‘ï¸ å·²æ¸…é™¤å†…å®¹";
  }
});
</script>

</body>
</html>
